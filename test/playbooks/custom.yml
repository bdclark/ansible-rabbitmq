---
- hosts: all
  become: yes
  vars:
    rabbitmq_default_user: admin
    rabbitmq_default_pass: admin
    rabbitmq_loopback_users:
      - admin

    rabbitmq_disk_free_limit: 50MB
    rabbitmq_vm_memory_high_watermark: 0.5

    rabbitmq_nodename: hare@vagrant
    rabbitmq_port: 5673
    rabbitmq_open_file_limit: 50000

    rabbitmq_cluster_mode: manual
    rabbitmq_cluster_master_node: hare@vagrant
    rabbitmq_cluster_name: rabbits

    rabbitmq_management_plugin_enabled: yes
    rabbitmq_management_ssl_enabled: yes
    rabbitmq_management_ssl_port: 15671

    rabbitmq_ssl_enabled: yes
    rabbitmq_ssl_port: 5671
    rabbitmq_ssl_verify: verify_peer
    rabbitmq_ssl_fail_if_no_peer_cert: no
    rabbitmq_ssl_cacert_content: |-
      -----BEGIN CERTIFICATE-----
      MIICxDCCAaygAwIBAgIJAKItO4DTUcsZMA0GCSqGSIb3DQEBBQUAMBIxEDAOBgNV
      BAMMB1NlbnN1Q0EwHhcNMTYxMjE5MTQ1MDQyWhcNMjExMjE4MTQ1MDQyWjASMRAw
      DgYDVQQDDAdTZW5zdUNBMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA
      rdUZ881aGW51cGzHK6g62X/GJ4M4IkdNs4grzC0iHAETsdgSX51atFlQsWMwhZAq
      yr6kGKvQSp1NGjaGTFj12lPqegQnEastG5Dph3bXGzwFV2JC9wTzc/gqZNuU/edI
      jtov6EfdqMOJYHEgW2J7bKsspmck3LYB5TE6Wpsof7+3NuDA89KlFevnop7l4cGC
      cEQjMGIMlnYgjK1y+6WjCEZVp4ifI5Mp5gZOy+6hdx3dkDAQC0fKXZOb/oLfmSUc
      W7oP39n3ul3xLW5DReJaP+0YrLF4aIHVT6sIr/pP5lwJklqA2ncoFf33tPTATTM7
      Q5H8Dr1qKVjXWpY4jVyovwIDAQABox0wGzAMBgNVHRMEBTADAQH/MAsGA1UdDwQE
      AwIBBjANBgkqhkiG9w0BAQUFAAOCAQEADrTAbSPhKGRfQe5DuztPEX9RMyIEBNlT
      qPDEiqDfRLQ4AaXYok7F3LqTgiD7ozY7liisBC7wN5d3xWactUOW33chNPO7U4uR
      iWSF0q2EyCP2EMbr8AObiQdv9AkEsWvpQvhw9WQMCN7pFyNOxpNbd5eIjGcUaTFI
      D6QjQAfkTOI96c+86TLhk8UjXz6IFPb8CxODVCSmi2IIDSYzP7M2fdv36xNkWMjP
      IYCnP8T6TxHCJihBAIw6SXZBgDieWjmsyXxXwF8KUsWRxoXBSvGtQwdidtEeBOQ8
      JGx8hv5lsdcS59n2cDoFODN/6BJ8TUlp28YqkCwVZ/CgnsQad9Ve7Q==
      -----END CERTIFICATE-----
    rabbitmq_ssl_cert_content: |-
        -----BEGIN CERTIFICATE-----
        MIIC3TCCAcWgAwIBAgIBAjANBgkqhkiG9w0BAQUFADASMRAwDgYDVQQDDAdTZW5z
        dUNBMB4XDTE2MTIxOTE0NTA0MloXDTIxMTIxODE0NTA0MlowITEOMAwGA1UEAwwF
        c2Vuc3UxDzANBgNVBAoMBmNsaWVudDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC
        AQoCggEBAJlzGruz1HnIqojUpBpfZgwRz1nxdN2SwtQP4Dj0O6bs1Oig6j8PyYg3
        tj+3tfWmZlZVDq+pMavicIxqMtzcTVOTdJ3xa+9Q52WukZzKo6skYeuBDyncjfyM
        Kpr0ibzf43mOJkeo0/AdwkB3mTrxikQ9rcc3+cpnm6hSCgQjU1nMx7E7trQPG6eV
        nHFhC2CtCOOIriu9AYtvoC4LGGDU/9LsDTxZIQUr9c6XfcvYzA9YWsnY2fRzPOWQ
        OafDl30CblzN0k2n+Fhrh/TipUa1Y4lnnZbkpqeMAGo804Iiy66dhOWkjBBhFtRr
        M/Z89YyWox7eRYho6RUO9aNcRtdhRRUCAwEAAaMvMC0wCQYDVR0TBAIwADALBgNV
        HQ8EBAMCB4AwEwYDVR0lBAwwCgYIKwYBBQUHAwIwDQYJKoZIhvcNAQEFBQADggEB
        ADsBmzvSt8Q/PN3HuDbo5VxWlRoOXtEUSta5BmKbMXwUqFL09V2Z5WqWZYDmd7no
        yD5kxlqxAKU3TfYFoFIjlxEGlyR0vUb1bfBdem21sAEeJmdLDLJFkQT/douk+mmP
        M0HNjE5usvr3f/xr1EDDyiFXlPNPOKt6pzvq12XbY63UmjMGnL4uJ5+2SlpsPaA/
        pZUb9/NjZ5cjyag09x/VboEFhn6DidHpz4G4li70tUJx9AFLemGNJf22xOWGxgm9
        TUyx1pjj2O9Inuv5HSrXpZqPj1qw7G80ECTFcWl92xFBKCgFpjAa+CSs2lHw7/Xb
        d7qoTr7V1pPhh1L36PwcXkQ=
        -----END CERTIFICATE-----
    rabbitmq_ssl_key_content: |-
        -----BEGIN RSA PRIVATE KEY-----
        MIIEpQIBAAKCAQEAmXMau7PUeciqiNSkGl9mDBHPWfF03ZLC1A/gOPQ7puzU6KDq
        Pw/JiDe2P7e19aZmVlUOr6kxq+JwjGoy3NxNU5N0nfFr71DnZa6RnMqjqyRh64EP
        KdyN/IwqmvSJvN/jeY4mR6jT8B3CQHeZOvGKRD2txzf5ymebqFIKBCNTWczHsTu2
        tA8bp5WccWELYK0I44iuK70Bi2+gLgsYYNT/0uwNPFkhBSv1zpd9y9jMD1haydjZ
        9HM85ZA5p8OXfQJuXM3STaf4WGuH9OKlRrVjiWedluSmp4wAajzTgiLLrp2E5aSM
        EGEW1Gsz9nz1jJajHt5FiGjpFQ71o1xG12FFFQIDAQABAoIBAQCNd1uG/nP9Tm1B
        tmAP3DFVITo7HmpyN3IcVQKPH0K7Uo26ZVdvidtvFIWVWoWLEbw5DTN76IzdfOXr
        3aBEk2lKip+xWLf8KmcaDAU8OmkHR4RqvFHBcw8HbCV/M8Cj+vhYwR8zY0b4kEbc
        biY6/CFPZlmGV2mXG0uasv9+7x5RoxZMXzZpA11BS+fqJfywlvlIY2gQAwa9u9K2
        dWm8DtCprK8pd9vIPH5fUrHr4+pp32k5rXKGVjZ9FMW/4scFM9KS8T3qnkRrNfdM
        hiFaLSCWxMaX6ZVcqzWB+FEaOcUth//Wqyi9RRCg3Q/uaWqwCP+kM+cLcq9EucKx
        NlV3qejBAoGBAMsNtAAC23pJMCzhcMbHjQlyR9uhcD6uW0thx30e86Qjq5rvxi+Y
        /vdo0lFSGhlUuOuBzWdF6ZZFTqQa1RUNqgZLN082Q7xkCm6hMjmGlrTzddn4iVJC
        N2spXNmoe/v74SgrqezuMW9lMNMmhu8P9BgL79f4sRwKI6czrGMYGhcRAoGBAMF2
        OaI55R7SUm59c90ifhL+tq7tArtlByTAoxNTXl68yJN1NR27x+LRtaB5zg9+Axt3
        qHxl+GrUw+NDou/40n2J+hAUqpP4KmVmzQAhsp3F//GwjM4LpV/3mGt+q1w4NzgN
        Pv1HkzAK23KDSiXaHnDmkjLN6kl0SE74Y0ayFzXFAoGAR2tDc3mNzt4tNqv4qcII
        Zlku0x5eR322GLaEnwqi8YmmUzGgyJ8MluLkjrvM+DnnbNZT884QUc2A0pGpfuU2
        d04/XvocKwgY7z59VuRy36R+QDN9wVQO//8lbF0pdsDqOeHZu78v3hl+adY0QaOf
        3FFeg90yFkWusqGnMZeJnbECgYEAgLzGj3CNSlxVJFdxMZdRZByBvpfTeJY7Ebbr
        DeIta0efBZk6VmXuFr7MaVSEzgRh1vZidR16GMUq8WHB3ISstYOKlwbZmAvNUpr9
        Efhanujyb4e3uyk+zES79dRd/cke3brazrrBdHfVHjfFsLicBy833HzwSh8KOxrJ
        HXNHRK0CgYEAmi7ydXxo9jkR7PVbjZCnQDdZbDnaaIpEuck7sB2mPoz3qpkN3hpQ
        1qOWSigev8rzD001ffUPY1Ib1tdG/bVY2RtLXcgG2y0PuIcLIGdajeCZNoo6KEbq
        ZihzvBLeICMVFKxdJhbMdWqIUQOaFz87J2CdoT6ECHWmpZciEx3gFUQ=
        -----END RSA PRIVATE KEY-----

    rabbitmq_vhosts:
      - name: vhost1
    rabbitmq_users:
      - user: user1
        password: changeme
        permissions:
          - vhost: vhost1
            configure_priv: .*
            write_priv: .*
            read_priv: .*
      - user: admin1
        password: changeme
        configure_priv: .*
        write_priv: .*
        read_priv: .*
  roles:
    - role: rabbitmq
